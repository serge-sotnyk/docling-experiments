# Feature Plan 0001: PDF to Markdown Console Utility

## Description

A console utility that takes a PDF file path as input, processes it using the Docling library with EasyOCR integration, and saves the resulting Markdown content alongside the original PDF file with a `.md` suffix.

## Files and Functions to be Changed/Created

### New Files to Create:
- `src/pdf_to_markdown/cli.py` - Main CLI entry point with argument parsing
- `src/pdf_to_markdown/converter.py` - Core PDF conversion logic using Docling
- `src/pdf_to_markdown/__init__.py` - Package initialization
- `pyproject.toml` (modification) - Add dependencies and console script entry point

### Dependencies to Add (via uv):
- `docling` - Core document processing library
- `easyocr` - OCR engine (Docling's default OCR)
- `click` - Command line interface handling
- `pathlib` - Path manipulation (built-in)


## Technical Implementation Details

### Algorithm Steps:

1. **Input Validation**:
   - Validate that input path exists and is a PDF file
   - Check file accessibility and permissions

2. **Docling Configuration**:
   - Initialize `DocumentConverter` with `PdfPipelineOptions`
   - Enable OCR with `do_ocr = True`
   - Configure `EasyOcrOptions` for OCR language support (default: English)
   - Set OCR options: `pipeline_options.ocr_options = EasyOcrOptions()`

3. **PDF Processing**:
   - Convert PDF using `doc_converter.convert(pdf_path)`
   - Extract the document result and check conversion status
   - Handle potential conversion errors gracefully

4. **Markdown Export**:
   - Use Docling's built-in Markdown serialization
   - Generate output filename by appending `.md` to original PDF name
   - Save Markdown content to the same directory as source PDF

5. **Output Generation**:
   - Create output file path: `{pdf_name}.pdf.md`
   - Write Markdown content to output file
   - Report success/failure status to user

### EasyOCR Integration:

Based on Docling documentation:
- EasyOCR is the default OCR engine and requires no special initialization
- Install via: `uv add easyocr` (included in dependencies above)
- Configuration through `PdfPipelineOptions.ocr_options = EasyOcrOptions()`
- Supports multiple languages via `ocr_options.lang = ["en"]` (configurable)
- GPU support available via `use_gpu` parameter in EasyOcrModel

### Core Implementation Structure:

```python
# converter.py structure
class PDFToMarkdownConverter:
    def __init__(self):
        # Initialize Docling pipeline with OCR
        
    def convert_pdf_to_markdown(self, pdf_path: Path) -> str:
        # Main conversion logic
        
    def save_markdown(self, content: str, output_path: Path) -> None:
        # Save markdown to file

# cli.py structure  
def main():
    # Parse CLI arguments
    # Validate input
    # Create converter instance
    # Process PDF and save result
```

### Error Handling:
- File not found errors
- Permission errors
- Docling conversion failures
- OCR processing errors
- Output file write errors

### Console Script Entry Point:
- Add to `pyproject.toml` under `[project.scripts]`:
  ```toml
  [project.scripts]
  pdf-to-md = "pdf_to_markdown.cli:main"
  ```
- After modifying pyproject.toml, run: `uv sync` to update the environment
- Enables usage via: `pdf-to-md /path/to/document.pdf`

### Development Workflow with uv:
1. Run the utility: `uv run pdf-to-md /path/to/document.pdf`
2. For development testing: `uv run python -m pdf_to_markdown.cli /path/to/document.pdf`
